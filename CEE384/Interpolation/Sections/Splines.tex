\section{Quadratic Splines}

A \textit{quadratic spline} is a set of piecewise quadratic functions which intersect all points in a dataset. There are three conditions that mathematically govern these functions. The first condition is that the functions must be \textit{continuous}. The second condition is that the functions must be \textit{smooth}, meaning that the derivatives are continous.

There are $3n$ unknowns, where $n$ is the number of data points in the dataset. This is because there is an $a_i$, $b_i$, and $c_i$, for each $i$ data point. We will look at a particular example with 4 points (shown in table \ref{tab:dataset}), and three connecting splines.

\begin{table}[H]
\begin{center}
\caption{Example dataset for quadratic spline}
\label{tab:dataset}
  \begin{tabular}{|c|c|c|c|c|}
    \hline
    $x$ & $x_0$ & $x_1$ & $x_2$ & $x_3$\\ \hline
    $y$ & $f(x_0)$ & $f(x_1)$ & $f(x_2)$ & $f(x_3)$\\
    \hline
  \end{tabular}
\end{center}
\end{table}

\begin{figure}[H]
\begin{center}
\begin{tikzpicture}
% Draw axes
\draw [<->,thick]
        (0,4) node (yaxis) [above] {$y$} |-
        (10,0) node (xaxis) [right] {$x$};
        
% Draw grid
\draw[gray, step=1cm] (0,0) grid (10,4);

% Draw path through points
        \draw [ultra thick]
        (1,1) -- 
        node[midway,above,sloped]
        {\small $a_1x^2+b_1x+c_1$}
        (3,2) .. controls (4,2.5) and (6,1) ..
        node[midway,above,sloped]
        {\small $a_2x^2+b_2x+c_2$}
        (6,1) .. controls (8,0) and (10,3) ..
        node[above,sloped]
        {\small $a_3x^2+b_3x+c_3$}
        (10,3);


% write x_0, x_1...
\draw[thick,dashed]
        (1,0) 
        node[below]{$x_0$} -- 
        (1,1);
\draw[thick,dashed]
        (3,0) 
        node[below]{$x_1$} -- 
        (3,2);
\draw[thick,dashed]
        (6,0) 
        node[below]{$x_2$} -- 
        (6,1);
\draw[thick,dashed]
        (10,0)
        node[below]{$x_3$} -- 
        (10,3);

% Draw points
\poi{1}{1}
\poi{3}{2}
\poi{6}{1}
\poi{10}{3}

\end{tikzpicture}
\caption{Example dataset plot with splines}
\label{fig:spline}
\end{center}
\end{figure}

\subsection{Continuous Functions}
The spline equations should be continuous and go through all the points in the dataset. This means that the 

\begin{align}
f(x)
=
\begin{cases}
a_1x^2 + b_1x + c_1 & x_0 < x < x_1\\
a_2x^2 + b_2x + c_2 & x_1 < x < x_2\\
a_3x^2 + b_3x + c_3 & x_2 < x < x_3\\
\end{cases}
\end{align}

The first spline equation must be equal at the start of the interval, $x_1$, to the value of dataset $f(x_0)$. As an equation this is:

\begin{align}
f(x_0) = a_1x_0^2 + b_1x_0 + c_1
\end{align}

At the point, $x_1$, the first spline equation must be equal to the output value from the dataset, $f(x_1)$. The second equation must \textit{also} be equal to this. Therefore this generates two additional equations:

\begin{align}
f(x_1) = a_1x_1^2 + b_1x_1 + c_1 \\
f(x_1) = a_2x_1^2 + b_2x_1 + c_2
\end{align}

At the second data point, $x_2$, the second and thrid spline must be equal to $f(x_2)$. This generates two additional equation.

\begin{align}
f(x_2) = a_2x_2^2 + b_2x_2 + c_2 \\
f(x_2) = a_3x_2^2 + b_3x_2 + c_3
\end{align}

Finally, the last spline must go through the last point, generating one more continuity equation:

\begin{align}
f(x_3) = a_3x_3^2 + b_3x_3 + c_3
\end{align}
%4 6 2*(4-1)
%5 8 2*(5-1)

This results in $6$ equations total leaving $3$ more unknowns that must be found. To generalize this pattern: for every $n$ points the continuity condition generates $2(n-1)$ equations.

\subsection{Smooth Functions}


\begin{pseudocode}
\item Define dataset or take dataset as input if programmed as a stand alone function
\item Initialize $\vec{A}$ as a matrix of zeros (3n,3n)
\item Loop through number of points and use continuous function information

\begin{enumerate}
\item Set values for first equation
\end{enumerate}

\item Loop through number of points and use continuous derivatives information
\begin{enumerate}
\item Use interior points
\end{enumerate}

\end{pseudocode}